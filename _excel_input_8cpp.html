<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>CLO Model: ExcelDllCLOModel/ExcelInput.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLO Model
   &#160;<span id="projectnumber">1.50</span>
   </div>
   <div id="projectbrief">Collateralised Loan Obligations Cash Flow Modeller</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8fa20e0f348a44a583d8ea892ebf2f8b.html">ExcelDllCLOModel</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ExcelInput.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Excel exported functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;ExcelCommons.h&quot;</code><br/>
<code>#include &quot;CentralUnit.h&quot;</code><br/>
<code>#include &quot;WatFalPrior.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="_excel_output_8h_source.html">ExcelOutput.h</a>&quot;</code><br/>
<code>#include &quot;SummaryView.h&quot;</code><br/>
<code>#include &quot;WaterfallViewer.h&quot;</code><br/>
<code>#include &quot;CommonFunctions.h&quot;</code><br/>
<code>#include &lt;QDate&gt;</code><br/>
<code>#include &lt;QString&gt;</code><br/>
<code>#include &lt;QFile&gt;</code><br/>
<code>#include &lt;QApplication&gt;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a60be20f670b8232ad4266cfbf726fc9e"><td class="memItemLeft" align="right" valign="top">double __stdcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_excel_input_8cpp.html#a60be20f670b8232ad4266cfbf726fc9e">CLODiscountMargin</a> (LPSAFEARRAY *ArrayData)</td></tr>
<tr class="memdesc:a60be20f670b8232ad4266cfbf726fc9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that gets the discount margin for a tranche from a result file.  <a href="#a60be20f670b8232ad4266cfbf726fc9e">More...</a><br/></td></tr>
<tr class="separator:a60be20f670b8232ad4266cfbf726fc9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac84486ea17bb9ed3c845758397e27d45"><td class="memItemLeft" align="right" valign="top">double __stdcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_excel_input_8cpp.html#ac84486ea17bb9ed3c845758397e27d45">CLOWALife</a> (LPSAFEARRAY *ArrayData)</td></tr>
<tr class="memdesc:ac84486ea17bb9ed3c845758397e27d45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that gets the weighted average life for a tranche from a result file.  <a href="#ac84486ea17bb9ed3c845758397e27d45">More...</a><br/></td></tr>
<tr class="separator:ac84486ea17bb9ed3c845758397e27d45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25db50c00f750752e21b2ffa4e29a612"><td class="memItemLeft" align="right" valign="top">void __stdcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_excel_input_8cpp.html#a25db50c00f750752e21b2ffa4e29a612">InspectStress</a> (LPSAFEARRAY *ArrayData)</td></tr>
<tr class="memdesc:a25db50c00f750752e21b2ffa4e29a612"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that displays the whole waterfall results for a given stress scenario.  <a href="#a25db50c00f750752e21b2ffa4e29a612">More...</a><br/></td></tr>
<tr class="separator:a25db50c00f750752e21b2ffa4e29a612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e8b676ff3e90297990790104c9ba27"><td class="memItemLeft" align="right" valign="top">void __stdcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_excel_input_8cpp.html#aa0e8b676ff3e90297990790104c9ba27">InspectWaterfall</a> (LPSAFEARRAY *ArrayData)</td></tr>
<tr class="memdesc:aa0e8b676ff3e90297990790104c9ba27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that displays the two waterfalls.  <a href="#aa0e8b676ff3e90297990790104c9ba27">More...</a><br/></td></tr>
<tr class="separator:aa0e8b676ff3e90297990790104c9ba27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbb1728b6ec66f579da7b48743228ed6"><td class="memItemLeft" align="right" valign="top">void __stdcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_excel_input_8cpp.html#acbb1728b6ec66f579da7b48743228ed6">RunModel</a> (LPSAFEARRAY *ArrayData)</td></tr>
<tr class="memdesc:acbb1728b6ec66f579da7b48743228ed6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that runs the cash flow model, and the stress test saves and prints the results in excel.  <a href="#acbb1728b6ec66f579da7b48743228ed6">More...</a><br/></td></tr>
<tr class="separator:acbb1728b6ec66f579da7b48743228ed6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace7187272ea192f7e46df4103285fe62"><td class="memItemLeft" align="right" valign="top">void __stdcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_excel_input_8cpp.html#ace7187272ea192f7e46df4103285fe62">StressTargetChanged</a> (LPSAFEARRAY *ArrayData)</td></tr>
<tr class="memdesc:ace7187272ea192f7e46df4103285fe62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that has to be called to get the stress results for a different tranche.  <a href="#ace7187272ea192f7e46df4103285fe62">More...</a><br/></td></tr>
<tr class="separator:ace7187272ea192f7e46df4103285fe62"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Excel exported functions. </p>
<dl class="section author"><dt>Author</dt><dd>Luca Beldi </dd></dl>
<dl class="section date"><dt>Date</dt><dd>November 2013</dd></dl>
<p>File containing the definition of the function exported into the dll and available through Excel </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a60be20f670b8232ad4266cfbf726fc9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double __stdcall CLODiscountMargin </td>
          <td>(</td>
          <td class="paramtype">LPSAFEARRAY *&#160;</td>
          <td class="paramname"><em>ArrayData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that gets the discount margin for a tranche from a result file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ArrayData</td><td>Excel Variant Array of Inputs </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The discount margin of the selected tranche</dd></dl>
<p>This function loads the results of the model and calculates the discount margin of a tranche associated with the given price</p>
<p>ArrayData must contain, in order:</p>
<ol type="1">
<li>A String containing the path to the stress result file</li>
<li>A String containing the name of the tranche for which you want to display the results</li>
<li>A Boolean defining if the calculation should consider the call option as exercised</li>
<li>A Double containing the price of the tranche </li>
</ol>

</div>
</div>
<a class="anchor" id="ac84486ea17bb9ed3c845758397e27d45"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double __stdcall CLOWALife </td>
          <td>(</td>
          <td class="paramtype">LPSAFEARRAY *&#160;</td>
          <td class="paramname"><em>ArrayData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that gets the weighted average life for a tranche from a result file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ArrayData</td><td>Excel Variant Array of Inputs </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The weighted average life of the selected tranche</dd></dl>
<p>This function loads the results of the model and calculates the weighted average life of a tranche</p>
<p>ArrayData must contain, in order:</p>
<ol type="1">
<li>A String containing the path to the stress result file</li>
<li>A String containing the name of the tranche for which you want to display the results</li>
<li>A string containing the date from which the WAL starts. It must be in the ISO 8601 format (yyyy-mm-dd)</li>
<li>A Boolean defining if the calculation should consider the call option as exercised </li>
</ol>

</div>
</div>
<a class="anchor" id="a25db50c00f750752e21b2ffa4e29a612"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __stdcall InspectStress </td>
          <td>(</td>
          <td class="paramtype">LPSAFEARRAY *&#160;</td>
          <td class="paramname"><em>ArrayData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that displays the whole waterfall results for a given stress scenario. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ArrayData</td><td>Excel Variant Array of Inputs</td></tr>
  </table>
  </dd>
</dl>
<p>This function creates a Widget containing the waterfall results for the given stress scenario</p>
<p>ArrayData must contain, in order:</p>
<ol type="1">
<li>A String containing the path to the stress result file</li>
<li>A String containing the value for the X Parameter</li>
<li>A String containing the value for the Y Parameter</li>
<li>A Long representing the <a class="el" href="class_stress_test.html#a6a5c48282fd83957ead56beee9c894c6" title="Enum defining what parameter is currently being stressed. ">StressTest::StressVariability</a> dimention for the X parameter</li>
<li>A Long representing the <a class="el" href="class_stress_test.html#a6a5c48282fd83957ead56beee9c894c6" title="Enum defining what parameter is currently being stressed. ">StressTest::StressVariability</a> dimention for the Y parameter</li>
</ol>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_summary_view.html">SummaryView</a> </dd></dl>

</div>
</div>
<a class="anchor" id="aa0e8b676ff3e90297990790104c9ba27"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __stdcall InspectWaterfall </td>
          <td>(</td>
          <td class="paramtype">LPSAFEARRAY *&#160;</td>
          <td class="paramname"><em>ArrayData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that displays the two waterfalls. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ArrayData</td><td>Excel Variant Array of Inputs</td></tr>
  </table>
  </dd>
</dl>
<p>This function creates a Widget containing two tables each of them showing one of the waterfalls.</p>
<p>ArrayData must contain, in order: </p>
<ol>
<li>
The number of steps in the aggregated waterfall </li>
<li>
For each step in the waterfall </li>
<li>
Long representing the <a class="el" href="class_wat_fal_prior.html#a20a06484b2ba511ba1bcf468a1b21bbe" title="Enum defining the different types of waterfall steps. ">WatFalPrior::WaterfallStepType</a> of the waterfall </li>
<li>
Long representing the target seniority group of the step </li>
<li>
Long representing funds sources or destination for the step </li>
<li>
Double between 0 and 1 representing the share of funds going toward redemption of the destination step (used only in OC Test)</li>
</ol>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_waterfall_viewer.html">WaterfallViewer</a> </dd></dl>

</div>
</div>
<a class="anchor" id="acbb1728b6ec66f579da7b48743228ed6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __stdcall RunModel </td>
          <td>(</td>
          <td class="paramtype">LPSAFEARRAY *&#160;</td>
          <td class="paramname"><em>ArrayData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that runs the cash flow model, and the stress test saves and prints the results in excel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ArrayData</td><td>Excel Variant Array of Inputs</td></tr>
  </table>
  </dd>
</dl>
<p>This function takes in input all the parameters of the model, runs the cash flows and saves the results. It then calls, when appropriate:</p>
<ul>
<li><a class="el" href="namespace_excel_output.html#a789a80a1a084055f09587090c5c56ded" title="Sends the information of the loans cash flows to excel. ">ExcelOutput::PrintMortgagesRepLines</a></li>
<li><a class="el" href="namespace_excel_output.html#a41aa3c05c0a7ffc699d8cce1a1f3a85f" title="Sends the information of the loans cash flows to excel to be charted. ">ExcelOutput::PlotMortgagesFlows</a></li>
<li><a class="el" href="namespace_excel_output.html#aea8aeb2022cadf54c6bcdfb98413428f" title="Sends the information of the tranche cash flows to excel. ">ExcelOutput::PrintTrancheFlow</a></li>
<li>ExcelOutput::PlotTranchesDynamic</li>
<li>ExcelOutput::PlotOCTest</li>
<li>ExcelOutput::PlotICTest</li>
<li>ExcelOutput::PlotAnnualExcess</li>
<li>ExcelOutput::PlotCostFunding</li>
</ul>
<p>To send the output to excel.</p>
<p>ArrayData must contain, in order: </p>
<ol>
<li>
A Long representing the number of loans in the pool </li>
<li>
For each loan in the pool: <ol type="a">
<li>
A String containing the maturity date of the loan in the ISO 8601 format (yyyy-mm-dd) </li>
<li>
A Double representing the current amount outstanding of the loan </li>
<li>
A String containing a Bloomberg-like vector that represents the interest rate payed on the loan </li>
<li>
A String containing a Bloomberg-like vector that represent if the loan is an annuity. The values must be either Y or N </li>
<li>
A Long representing the number of months between two loans payments (e.g. if the loan pays quarterly this must be 3) </li>
<li>
A Double representing the multiplier by which the loans is more likely to prepay compared to the base hypothesis. 100 is the base case. </li>
<li>
A Double representing the multiplier by which the loans is more likely to experience losses compared to the base hypothesis. 100 is the base case.</li>
</ol>
</li>
<li>
A Long representing the number of tranches of the deal </li>
<li>
For each tranche in the deal: <ol type="a">
<li>
A String containing the name of the tranche </li>
<li>
A Long representing the redemption priority level of the note (pro rata group) </li>
<li>
A Double containing the original amount outstanding of the note </li>
<li>
A String containing the Bloomberg code of the note currency (e.g. USD, EUR, GBP) </li>
<li>
A double containing the current amount outstanding of the note </li>
<li>
A Long representing the <a class="el" href="class_tranche.html#a4788489fed0cb08f20e3ff7c22bbdbde" title="Enum defining what type of coupon the tranche is paying. ">Tranche::TrancheInterestType</a> code determining if the notes pays fixed or floating interest </li>
<li>
A Double containing the margin or the interest rate paid by the note (in basis points) </li>
<li>
A String containing the Bloomberg ticker of the of the reference rate for the interest (if the note pays fixed interest this will be ignored) </li>
<li>
A String containing the last IPD in the ISO 8601 format (yyyy-mm-dd) </li>
<li>
A String containing the Bloomberg ticker of the base rate on which discount margin will be calculated for fixed rate notes (for floating rate notes this will be ignored) </li>
<li>
A Long containing the the number of months between two IPDs (e.g. if the deal pays quarterly this must be 3) </li>
<li>
A Double containing the value of the reference rate for the note. -1.0 will cause the program to get the value from Bloomberg </li>
<li>
A Double containing the limit of the OC test for the tranche (100% = 1.0) </li>
<li>
A Double containing the limit of the IC test for the tranche (100% = 1.0) </li>
<li>
A Double containing the price for the note in a 100 basis </li>
<li>
A Double containing the exchange rate for the note currency (1.0 for the currency in which the loans are denominated) </li>
<li>
A String containing the settlement date in the ISO 8601 format (yyyy-mm-dd) </li>
<li>
A Double representing the interest accrued on the note from the last IPD</li>
</ol>
</li>
<li>
A Long containing the number of steps in the waterfall </li>
<li>
For each step in the waterfall: <ol type="a">
<li>
A Long representing the <a class="el" href="class_wat_fal_prior.html#a20a06484b2ba511ba1bcf468a1b21bbe" title="Enum defining the different types of waterfall steps. ">WatFalPrior::WaterfallStepType</a> code for the step </li>
<li>
A Long representing the pro rata group to which the step is referred to </li>
<li>
A Long representing the source or destination of the payments due to this step (e.g. For Senior Expenses a 1 will deduct the expenses from interest while a 2 will deduct them from principal. For OC test this is the tranche that will be redeemed if the test fails) </li>
<li>
A Double, used only in OC test and ignored otherwise, that determines what share of available funds will go toward the redemption of the note specified in the previous argument. The rest will go on top of the principal waterfall.</li>
</ol>
</li>
<li>
A Double containing senior expenses rate as a share of loans outstanding </li>
<li>
A Double containing senior fees rate as a share of loans outstanding </li>
<li>
A Double containing junior fees rate as a share of loans outstanding </li>
<li>
A Double containing the interest rate at which unpaid junior fees are compounded </li>
<li>
A Long containing the the number of months between two IPDs (e.g. if the deal pays quarterly this must be 3) </li>
<li>
A String containing the next IPD in the ISO 8601 format (yyyy-mm-dd) </li>
<li>
A String containing the previous IPD in the ISO 8601 format (yyyy-mm-dd) </li>
<li>
A Boolean: if set to false, reinvestment test and OC test turbo features will not be used </li>
<li>
A String containing a Bloomberg-like vector that represents the evoulution of CCC loans as a share of total loans </li>
<li>
A Double representing the haircut inflicted to CCC loans if the CCC test is failed </li>
<li>
A Double representing the CCC test limit </li>
<li>
A String containing the call date in the ISO 8601 format (yyyy-mm-dd). Empty string ("") if not applicable </li>
<li>
A Double by which the call reserve (see below) is multiplied for computing the call event. 0 if not applicable </li>
<li>
A Double containing the call reserve. It can be either a seniority level or an absolute amount. When the outstanding amount of the notes gets below this amount the deal will be called. 0 if not applicable </li>
<li>
A Double representing the value of the loan pool at the call date (in basis 100) </li>
<li>
A String containing the reinvestment period end date in the ISO 8601 format (yyyy-mm-dd). </li>
<li>
A Double representing the reinvestment test limit </li>
<li>
A Double representing how much interest will be diverted to notes redemption during the reinvestment period in case the reinvestment test is breached </li>
<li>
A Double representing how much interest will be diverted to acquire new collateral during the reinvestment period in case the reinvestment test is breached </li>
<li>
A Double representing how much interest will be diverted to notes redemption after the reinvestment period in case the reinvestment test is breached </li>
<li>
A Double representing how much interest will be diverted to acquire new collateral after the reinvestment period in case the reinvestment test is breached </li>
<li>
A String containing a Bloomberg-like vector that represents the spread payed by new collateral coming from reinvestment </li>
<li>
A String containing a Bloomberg-like vector that represents the CPR assumption for the model </li>
<li>
A String containing a Bloomberg-like vector that represents the CDR assumption for the model </li>
<li>
A String containing a Bloomberg-like vector that represents the LS assumption for the model </li>
<li>
A String containing a Bloomberg-like vector that represents the WAL (in years) of the reinvestment bond </li>
<li>
A Long representing the number of months between two payments made by newly acquired loans (e.g. if the loans pay quarterly this must be 3) </li>
<li>
A String containing the Bloomberg ticker of the of the reference rate for the new loans coming from reinvestment </li>
<li>
A Double containing the principal available amounts currently in the cash account of the issuer </li>
<li>
A Double containing the interest available amounts currently in the cash account of the issuer </li>
<li>
A String containing the pool cut off date in the ISO 8601 format (yyyy-mm-dd). </li>
<li>
A Boolean that determines if the call hypothesis should be evaluated or not </li>
<li>
A String containing the address of the cell where the loans cash flows should be printed. Empty string ("") if you don't want them to be printed </li>
<li>
A String containing the address of the cell where the tranches cash flows should be printed. Empty string ("") if you don't want them to be printed </li>
<li>
A String containing the name of the sheet where the charts are located </li>
<li>
A Long representing the index of the chart object where the loans cash flow graph should be printed on </li>
<li>
A Long representing the index of the chart object where the tranches cash flow graph should be printed on </li>
<li>
A Long representing the index of the chart object where the OC test graph should be printed on </li>
<li>
A Long representing the index of the chart object where the IC test graph should be printed on </li>
<li>
A Long representing the index of the chart object where the excess spread graph should be printed on </li>
<li>
A Long representing the index of the chart object where the WA cost of capital graph should be printed on </li>
<li>
A String containing the address of the cell where the loss rates of the notes should be printed. Empty string ("") if you don't want them to be printed </li>
<li>
A String containing the address of the cell where the loss rates of the notes, in the call scenario, should be printed. Empty string ("") if you don't want them to be printed </li>
<li>
A String containing the address of the cell where the credit enhancement of the notes should be printed. Empty string ("") if you don't want them to be printed </li>
<li>
A String containing the path to the folder where the results should be saved to </li>
<li>
A Boolean representing if the stress test should be run or just the base model</li>
</ol>
<p>In case the stress test should be run, this additional inputs, in order, are necessary: </p>
<ol start="53">
<li>
A String containing a Bloomberg-like vector that represents the parameter that will be kept constant in the stress test </li>
<li>
A Long representing the <a class="el" href="class_stress_test.html#a6a5c48282fd83957ead56beee9c894c6" title="Enum defining what parameter is currently being stressed. ">StressTest::StressVariability</a> code for the rows variation dimension </li>
<li>
A Long representing the <a class="el" href="class_stress_test.html#a6a5c48282fd83957ead56beee9c894c6" title="Enum defining what parameter is currently being stressed. ">StressTest::StressVariability</a> code for the columns variation dimension </li>
<li>
A Long containing the number of scenarios on the rows variation dimension </li>
<li>
For scenario on the rows variation dimension: <ol type="a">
<li>
A String containing a Bloomberg-like vector that represents the variable stress value</li>
</ol>
</li>
<li>
A Long containing the number of scenarios on the columns variation dimension </li>
<li>
For scenario on the columns variation dimension: <ol type="a">
<li>
A String containing a Bloomberg-like vector that represents the variable stress value</li>
</ol>
</li>
<li>
A Boolean determining if the stress test should consider the call scenario </li>
</ol>
<dl class="section warning"><dt>Warning</dt><dd>Long refers to 32 bits integers. Using 16 bits one (Integer instead of Long in VBA) will lead to a crash </dd></dl>

</div>
</div>
<a class="anchor" id="ace7187272ea192f7e46df4103285fe62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __stdcall StressTargetChanged </td>
          <td>(</td>
          <td class="paramtype">LPSAFEARRAY *&#160;</td>
          <td class="paramname"><em>ArrayData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that has to be called to get the stress results for a different tranche. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ArrayData</td><td>Excel Variant Array of Inputs</td></tr>
  </table>
  </dd>
</dl>
<p>This function loads the results of the stress test and invokes ExcelOutput::PrintStressTest() to send the stress test results of the appropriate tranche back to excel.</p>
<p>ArrayData must contain, in order:</p>
<ol type="1">
<li>A String containing the path to the stress result file</li>
<li>A String containing the name of the tranche for which you want to display the results</li>
<li>A string containing the address of the cell where the stress results should be printed</li>
<li>A Long representing the <a class="el" href="class_stress_test.html#a6a5c48282fd83957ead56beee9c894c6" title="Enum defining what parameter is currently being stressed. ">StressTest::StressVariability</a> dimention for the X parameter</li>
<li>A Long representing the <a class="el" href="class_stress_test.html#a6a5c48282fd83957ead56beee9c894c6" title="Enum defining what parameter is currently being stressed. ">StressTest::StressVariability</a> dimention for the Y parameter</li>
<li>A double representing the price of the tranche</li>
<li>A String containing the name of the sheet where the discount margin plot should appear</li>
<li>A Long containing the index of the Chart where the discount margin plot should be displayed</li>
</ol>
<dl class="section see"><dt>See Also</dt><dd>ExcelOutput::PrintStressTest() </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Dec 5 2013 10:05:50 for CLO Model by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
